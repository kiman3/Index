!function($){function e(){function e(){t.eq(n++).css("visibility","visible").hide().velocity("fadeIn",{duration:650}),n!=t.length&&setTimeout(e,100)}if($(b).hasClass("already-here"))$(".project").css("visibility","visible").show();else{for(var t=$(".project").css("visibility","hidden"),n=0,o,i,r=t.length;r;o=parseInt(Math.random()*r),i=t[--r],t[r]=t[o],t[o]=i);e()}}function t(){$(document).on("mousemove",function(e){$(".cursor").css({transform:"translate("+e.clientX+"px ,"+e.clientY+"px)"}),0!=$(".entry-img:hover").length?$(".cursor").fadeIn(500):$(".cursor").fadeOut(500)})}function n(){function e(){$(".archive-sort-btn").on("click",function(){var e=$(this).attr("data-sort-value"),n=$(this).hasClass("sort-asc");n?$(this).removeClass("sort-asc"):$(this).addClass("sort-asc"),t.isotope({sortBy:e,sortAscending:!n})})}var t=$(".archived-projects-wrap").isotope({getSortData:{title:".archived-project-title",client:".archived-project-client",typology:".archived-project-typology",year:".archived-project-year"},itemSelector:".archived-project",layoutMode:"vertical"});e()}function o(){scrollPos=0,$(window).scroll(function(){scrollPos=$(document).scrollTop()})}function i(){entryImg=$(".entry-img"),$(entryImg).click(function(){c(),entryNumber=$(this).attr("data-asset-number"),entryNextNumber=++entryNumber,entryNext=$("#entry-img-"+entryNextNumber),entryFirst=$("#entry-img-1"),scrollPos>0?$(g).velocity("scroll",{offset:entryNext.offset().top-36,duration:500}):$(g).velocity("scroll",{offset:entryFirst.offset().top-36,duration:500})})}function r(){$("#projects-container").imagesLoaded().always(function(e){}).done(function(e){}).fail(function(){}).progress(function(e,t){$(t.img).css("visibility","visible").hide().velocity("fadeIn",{duration:800})})}function a(e){$(e).hover(function(){$(e).not(this).addClass("hover-out")},function(){$(e).removeClass("hover-out")})}function c(){g.on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){g.velocity("stop")})}function s(){$('a[href*="#"]:not([href="#"])').on("click",function(){if(c(),location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if(e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length)return $(g).animate({scrollTop:e.offset().top},1400,"",function(){}),$(g).velocity("scroll",{offset:e.offset().top,duration:1400}),!1}})}function l(){$(".scroll-top").on("click",function(e){e.preventDefault(),c(),$(g).stop().velocity("scroll",{duration:1500,offset:0,mobileHA:!1})})}function d(){var e=0;$(".entry-read-more").on("click",function(e){u(),docHeight=$(document).outerHeight(),entryPreambleHeight=$(".entry-preamble").outerHeight()+$(".footer-main").outerHeight+40,entryPreambleHeight>windowHeight?scrollToPreamble=docHeight-entryPreambleHeight:scrollToPreamble=docHeight-windowHeight,e.preventDefault(),c(),$(g).stop().velocity("scroll",{duration:1500,offset:scrollToPreamble,mobileHA:!1})})}function u(){windowHeight=window.innerHeight?window.innerHeight:$(window).height(),windowWidth=window.innerWidth?window.innerWidth:$(window).width()}function h(){function e(){$(".project-img").addClass("moveable"),$(document).on("mousemove",function(e){$(".moveable").css({transform:"translate("+e.clientX+"px ,"+e.clientY+"px)"})})}windowWidth>=960&&e(),$(window).resize(function(){u();var t=$(".project-img");windowWidth>=960?e():($(t).css({transform:"translate(0, 0)"}),$(t).removeClass("moveable"))})}function f(){for(var e=document.getElementsByTagName("iframe"),t=0;t<e.length;t++){var n=e[t],o=/www.youtube.com|player.vimeo.com/;if(n.src.search(o)>0){var i=n.height/n.width*100;n.style.position="absolute",n.style.top="0",n.style.left="0",n.width="100%",n.height="100%";var r=document.createElement("div");r.className="fluid-vids",r.style.width="100%",r.style.position="relative",r.style.paddingTop=i+"%";n.parentNode.insertBefore(r,n),r.appendChild(n)}}}function m(){var e=$('a[rel="home');$(e).on("click",function(){$(b).addClass("already-here")})}function v(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function p(e,t){var n=e.getBoundingClientRect();return{x:t.touches[0].clientX-n.left,y:t.touches[0].clientY-n.top}}function w(){T&&(L.moveTo(k.x,k.y),L.lineTo(N.x,N.y),L.stroke(),k=N)}function y(){E.width=E.width,L.lineWidth=.01}var g=$("html, body"),b=$("body"),C=$(".project");e(),t(),n(),o(),i(),r(),a(".archived-project"),l(),d(),u(),h(),f(),m(),$(function(){var t=$("body"),c={anchors:"a",cacheLength:4,loadingClass:"is-loading",onStart:{duration:500,render:function(e){e.addClass("pfft")}},onAfter:function(t,c){i(),a(".archived-project"),h(),r(),e(),m(),f(),o(),n(),s(),l(),u(),t.removeClass("pfft")},prefetch:!0};$("#container").smoothState(c)});var E=$("#c"),H=$(window).width(),j=$(window).height();docH=$(document).height(),$(E).attr("width",H),$(E).attr("height",docH),$(E).addClass("active"),window.requestAnimFrame=function(e){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimaitonFrame||function(e){window.setTimeout(e,1e3/60)}}();var x,A;$(document).mousemove(function(e){return x=e.pageX,A=e.pageY,x;return A});var E=document.getElementById("c");if($("#canvas").length>0){var b=document.body,L=E.getContext("2d");L.strokeStyle="#000",L.font="bold 16px Arial",L.lineWidth=.25,L.translate(.5,.5),L.lineJoin=L.lineCap="round";var T=!0,N={x:x,y:A},k=N;b.addEventListener("mousedown",function(e){T=!0,k=v(E,e)},!1),b.addEventListener("mouseup",function(e){T=!0},!1),b.addEventListener("mousemove",function(e){N=v(E,e)},!1),E.addEventListener("touchstart",function(e){N=p(E,e);var t=e.touches[0],n=new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY});E.dispatchEvent(n)},!1),E.addEventListener("touchend",function(e){var t=new MouseEvent("mouseup",{});E.dispatchEvent(t)},!1),E.addEventListener("touchmove",function(e){var t=e.touches[0],n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});E.dispatchEvent(n)},!1),document.body.addEventListener("touchstart",function(e){e.target==E&&e.preventDefault()},!1),document.body.addEventListener("touchend",function(e){e.target==E&&e.preventDefault()},!1),document.body.addEventListener("touchmove",function(e){e.target==E&&e.preventDefault()},!1),function e(){requestAnimFrame(e),w()}(),$(window).on("beforeunload",function(){var e=E.toDataURL();console.log(e),$.ajax({type:"POST",url:"upload.php",data:{imgBase64:e}}).done(function(e){console.log("Saved")})})}}(jQuery);